{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/LENOVO/Downloads/One%20click/src/api/companies.ts"],"sourcesContent":["import { apiClient } from \"./client\";\nimport { API_ENDPOINTS } from \"./config\";\nimport {\n  Company,\n  GetCompaniesResponse,\n  ApiResponse,\n  GetInsuranceTypesResponse,\n  InsuranceType,\n} from \"./types\";\n\nexport const companiesApi = {\n  /**\n   * Fetch all companies\n   * @returns GetCompaniesResponse - API response containing company array\n   */\n  async getComapines(): Promise<GetCompaniesResponse> {\n    const response: ApiResponse<Company[]> = await apiClient.get(\n      API_ENDPOINTS.GET_COMPANIES\n    );\n\n    // Ensure response is shaped like GetCompaniesResponse\n    return {\n      status: response.status,\n      message: response.message,\n      count: response.data?.length || 0,\n      data: response.data || [],\n    };\n  },\n\n  /**\n   * Create uplpad api\n   */\n  async uploadCompany(company: Company, file: File): Promise<ApiResponse> {\n    const formData = new FormData();\n    formData.append(\"name\", company.name);\n    formData.append(\"id\", company.id);\n    formData.append(\"status\", company.status);\n    if (file) formData.append(\"file\", file);\n\n    const response = await apiClient.upload<ApiResponse>(\n      API_ENDPOINTS.SAVE_COMPANIE,\n      formData\n    );\n\n    return response;\n  },\n\n  /**\n   * Save or update a company (optional for later)\n   */\n  // async saveCompany(company: Company, file?: File): Promise<Company> {\n  //   const formData = new FormData();\n  //   formData.append('name', company.name);\n  //   formData.append('status', company.status);\n  //   if (file) formData.append('file', file);\n\n  //   const response = await apiClient.upload<Company>(API_ENDPOINTS.SAVE_COMPANY, formData);\n\n  //   if (response.status === 'success' && response.data) {\n  //     return response.data;\n  //   } else {\n  //     throw new Error(response.message || 'Failed to save company');\n  //   }\n  // },\n};\n\nexport const insuranceApi = {\n  /**\n   * Fetch all insurance types\n   * @returns GetInsuranceTypesResponse - API response containing insurance array\n   */\n  async getInsurances(): Promise<GetInsuranceTypesResponse> {\n    const response: ApiResponse<InsuranceType[]> = await apiClient.get(\n      API_ENDPOINTS.GET_INSURANCE\n    );\n\n    return {\n      status: response.status as \"success\" | \"error\",\n      message: response.message,\n      count: response.count || response.data?.length || 0,\n      data: response.data || [],\n    };\n  },\n\n  /**\n   * Create or update insurance type\n   */\n  async saveInsurance(insurance: InsuranceType): Promise<ApiResponse> {\n    const formData = new FormData();\n    if (insurance.id) formData.append(\"id\", insurance.id); // optional for update\n    formData.append(\"name\", insurance.name);\n    formData.append(\"status\", insurance.status);\n\n    const response = await apiClient.upload<ApiResponse>(\n      API_ENDPOINTS.SAVE_INSURANCE,\n      formData\n    );\n\n    return response;\n  },\n};\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AASO,MAAM,eAAe;IAC1B;;;GAGC,GACD,MAAM;QACJ,MAAM,WAAmC,MAAM,qJAAS,CAAC,GAAG,CAC1D,yJAAa,CAAC,aAAa;QAG7B,sDAAsD;QACtD,OAAO;YACL,QAAQ,SAAS,MAAM;YACvB,SAAS,SAAS,OAAO;YACzB,OAAO,SAAS,IAAI,EAAE,UAAU;YAChC,MAAM,SAAS,IAAI,IAAI,EAAE;QAC3B;IACF;IAEA;;GAEC,GACD,MAAM,eAAc,OAAgB,EAAE,IAAU;QAC9C,MAAM,WAAW,IAAI;QACrB,SAAS,MAAM,CAAC,QAAQ,QAAQ,IAAI;QACpC,SAAS,MAAM,CAAC,MAAM,QAAQ,EAAE;QAChC,SAAS,MAAM,CAAC,UAAU,QAAQ,MAAM;QACxC,IAAI,MAAM,SAAS,MAAM,CAAC,QAAQ;QAElC,MAAM,WAAW,MAAM,qJAAS,CAAC,MAAM,CACrC,yJAAa,CAAC,aAAa,EAC3B;QAGF,OAAO;IACT;AAmBF;AAEO,MAAM,eAAe;IAC1B;;;GAGC,GACD,MAAM;QACJ,MAAM,WAAyC,MAAM,qJAAS,CAAC,GAAG,CAChE,yJAAa,CAAC,aAAa;QAG7B,OAAO;YACL,QAAQ,SAAS,MAAM;YACvB,SAAS,SAAS,OAAO;YACzB,OAAO,SAAS,KAAK,IAAI,SAAS,IAAI,EAAE,UAAU;YAClD,MAAM,SAAS,IAAI,IAAI,EAAE;QAC3B;IACF;IAEA;;GAEC,GACD,MAAM,eAAc,SAAwB;QAC1C,MAAM,WAAW,IAAI;QACrB,IAAI,UAAU,EAAE,EAAE,SAAS,MAAM,CAAC,MAAM,UAAU,EAAE,GAAG,sBAAsB;QAC7E,SAAS,MAAM,CAAC,QAAQ,UAAU,IAAI;QACtC,SAAS,MAAM,CAAC,UAAU,UAAU,MAAM;QAE1C,MAAM,WAAW,MAAM,qJAAS,CAAC,MAAM,CACrC,yJAAa,CAAC,cAAc,EAC5B;QAGF,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/LENOVO/Downloads/One%20click/src/pages/companies.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport {\n  Table,\n  Button,\n  message,\n  Tag,\n  Modal,\n  Form,\n  Input,\n  Upload,\n  Switch,\n} from \"antd\";\nimport { EditOutlined, UploadOutlined } from \"@ant-design/icons\";\nimport { ColumnType } from \"antd/es/table\";\nimport toast from \"react-hot-toast\";\nimport type { UploadFile } from \"antd/es/upload/interface\";\nimport { Company } from \"@/api/types\";\nimport { companiesApi } from \"@/api/companies\";\nimport { API_CONFIG } from \"@/api/config\";\n\nconst CompaniesPage: React.FC = () => {\n  const [companies, setCompanies] = useState<Company[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [modalOpen, setModalOpen] = useState(false);\n  const [editingCompany, setEditingCompany] = useState<Company | null>(null);\n  const [form] = Form.useForm();\n  const [fileList, setFileList] = useState<UploadFile[]>([]);\n  const [saving, setSaving] = useState(false);\n\n  // For image modal\n  const [isImageModalOpen, setIsImageModalOpen] = useState(false);\n  const [selectedLogo, setSelectedLogo] = useState<string | null>(null);\n  const [selectedCompanyName, setSelectedCompanyName] = useState<string>(\"\");\n\n  // Track logo errors\n  const [logoErrorMap, setLogoErrorMap] = useState<{ [id: string]: boolean }>(\n    {}\n  );\n\n  const loadCompanies = async () => {\n    setLoading(true);\n    try {\n      const response = await companiesApi.getComapines();\n      const companiesData: Company[] = response?.data || [];\n      setCompanies(companiesData);\n    } catch (err) {\n      console.error(\"Error fetching companies:\", err);\n      message.error(\"Failed to fetch companies.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadCompanies();\n  }, []);\n\n  useEffect(() => {\n    if (editingCompany) {\n      form.setFieldsValue({\n        name: editingCompany.name,\n        status: editingCompany.status === \"Active\",\n      });\n      if (editingCompany.image_url) {\n        setFileList([\n          {\n            uid: \"-1\",\n            name: \"logo.png\",\n            status: \"done\",\n            url: editingCompany.image_url,\n          },\n        ]);\n      }\n    } else {\n      form.resetFields();\n      form.setFieldsValue({ status: true });\n      setFileList([]);\n    }\n  }, [editingCompany, form, modalOpen]);\n\n  const handleSave = async () => {\n    try {\n      const values = await form.validateFields();\n      setSaving(true);\n\n      const file = fileList[0]?.originFileObj as File;\n\n      const company: Company = {\n        id: editingCompany?.id || \"-1\",\n        name: values.name,\n        status: values.status ? \"Active\" : \"Inactive\",\n        logo: file,\n        image_url: editingCompany?.image_url || \"\",\n      };\n\n      const response = await toast.promise(\n        companiesApi.uploadCompany(company, file),\n        {\n          loading: \"Saving company...\",\n          success: \"Company saved successfully!\",\n          error: \"Failed to save company\",\n        }\n      );\n\n      if (response.status === \"success\") {\n        loadCompanies();\n        setModalOpen(false);\n        setEditingCompany(null);\n        form.resetFields();\n        setFileList([]);\n      } else {\n        throw new Error(response.message || \"Failed to save company\");\n      }\n    } catch (err) {\n      console.error(\"Error saving company:\", err);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleLogoClick = (logo: string, name: string) => {\n    setSelectedLogo(logo);\n    setSelectedCompanyName(name);\n    setIsImageModalOpen(true);\n  };\n\n  const handleUploadChange = ({ fileList }: { fileList: UploadFile[] }) => {\n    setFileList(fileList);\n  };\n\n  const handleLogoError = (id: string) => {\n    setLogoErrorMap((prev) => ({ ...prev, [id]: true }));\n  };\n\n  const columns: ColumnType<Company>[] = [\n    {\n      title: \"Name\",\n      dataIndex: \"name\",\n      key: \"name\",\n      align: \"left\",\n    },\n    {\n      title: \"Logo\",\n      dataIndex: \"image_url\",\n      key: \"logo\",\n      align: \"left\",\n      render: (logo: string, record: Company) => {\n        const isError = logoErrorMap[record.id];\n        \n        if (!logo || isError) return \"No Logo\";\n\n        let fullUrl = logo;\n        if (!logo.startsWith(\"http\")) {\n            const baseUrl = typeof API_CONFIG.BASE_URL === 'string' \n                ? API_CONFIG.BASE_URL.replace(/\\/api\\/proxy$/, '') \n                : \"\";\n            \n            const domain = baseUrl.startsWith(\"http\") ? baseUrl : \"https://appapi.1clickpolicy.com\";\n            \n            const cleanPath = logo.startsWith(\"/\") ? logo : `/${logo}`;\n            fullUrl = `${domain}${cleanPath}`;\n        }\n\n        return (\n          <img\n            src={fullUrl}\n            alt=\"logo\"\n            width={50}\n            style={{ cursor: \"pointer\" }}\n            onClick={() => handleLogoClick(fullUrl, record.name)}\n            onError={() => handleLogoError(record.id)}\n          />\n        );\n      },\n    },\n    {\n      title: \"Status\",\n      dataIndex: \"status\",\n      key: \"status\",\n      align: \"left\",\n      render: (status: string) => {\n        const isActive = status.toLowerCase() === \"active\";\n        return <Tag color={isActive ? \"green\" : \"red\"}>{status}</Tag>;\n      },\n    },\n    {\n      title: \"Actions\",\n      key: \"actions\",\n      align: \"right\",\n      render: (_: unknown, record: Company) => (\n        <Button\n          type=\"primary\"\n          icon={<EditOutlined />}\n          onClick={() => {\n            setEditingCompany(record);\n            setModalOpen(true);\n          }}\n        >\n          Edit\n        </Button>\n      ),\n    },\n  ];\n\n  return (\n    <div>\n      <div className=\"flex justify-between items-center mb-4\">\n        <h1 className=\"text-xl font-semibold\">Companies</h1>\n        <Button\n          type=\"primary\"\n          onClick={() => {\n            setEditingCompany(null);\n            setModalOpen(true);\n          }}\n        >\n          Add Company\n        </Button>\n      </div>\n\n      <Table\n        columns={columns}\n        dataSource={companies}\n        loading={loading}\n        rowKey=\"id\"\n      />\n\n      {/* Modal for Add/Edit */}\n      <Modal\n        title={editingCompany ? \"Edit Company\" : \"Add New Company\"}\n        open={modalOpen}\n        onCancel={() => {\n          setModalOpen(false);\n          setEditingCompany(null);\n          form.resetFields();\n          setFileList([]);\n        }}\n        onOk={handleSave}\n        confirmLoading={saving}\n        centered\n        destroyOnClose\n        okText={editingCompany ? \"Update\" : \"Submit\"}\n      >\n        <Form layout=\"vertical\" form={form}>\n          <Form.Item\n            label=\"Company Name\"\n            name=\"name\"\n            rules={[{ required: true, message: \"Please enter company name\" }]}\n          >\n            <Input placeholder=\"Enter company name\" />\n          </Form.Item>\n\n          <Form.Item label=\"Logo\">\n            <Upload\n              listType=\"picture\"\n              fileList={fileList}\n              beforeUpload={() => false}\n              onChange={handleUploadChange}\n              maxCount={1}\n            >\n              <Button icon={<UploadOutlined />}>Select Logo</Button>\n            </Upload>\n          </Form.Item>\n\n          <Form.Item label=\"Status\" name=\"status\" valuePropName=\"checked\">\n            <Switch checkedChildren=\"Active\" unCheckedChildren=\"Inactive\" />\n          </Form.Item>\n        </Form>\n      </Modal>\n\n      {/* Modal to view full logo */}\n      <Modal\n        open={isImageModalOpen}\n        footer={null}\n        onCancel={() => setIsImageModalOpen(false)}\n        centered\n      >\n        <h2 style={{ textAlign: \"center\", marginBottom: 16 }}>\n          {selectedCompanyName}\n        </h2>\n        <img\n          src={selectedLogo || \"\"}\n          alt=\"Company Logo\"\n          style={{ width: \"100%\", maxHeight: \"400px\", objectFit: \"contain\" }}\n        />\n      </Modal>\n    </div>\n  );\n};\n\nexport default CompaniesPage;\n"],"names":[],"mappings":"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","debugId":null}}]
}